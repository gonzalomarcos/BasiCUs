# BasiCUs 

## Idea
The idea of this project is deploying basic use cases that I consider that should be enabled/deployed in every SIEM. The rules have been considered based on the log sources, taking into account the volume of the logs generated by the technology and the easiness of deploying the use case. We will split the UCs based on the system source. 
I have split the environment in the following systems:
- Core
  - Should be present across all systems
- Servers
  - Internet facing servers and internal servers
- Endpoints
  - Users endpoints
- DCs/AD
  - Uses cases based on domain controllers or common attacks to active directory
- ATMs
  - ATMs use cases

All these detection rules will try to look for common TTPs used by APTs. All the use cases will have a sigma link to check it's logic. 
Checked most used TTPs to create the BasiCUs

https://resource.redcanary.com/rs/003-YRU-314/images/2020-Threat-Detection-Report.pdf

https://redcanary.com/threat-detection-report/techniques/windows-management-instrumentation/

## Prioritization

I have prioritized one log sources over others in order to create the UCs. I have took into account that in the same log source it can be different volumes of events, for example, I have prioritized any windows events over process creation in case it was possible since the volume of the proccess creation logs is way bigger.



## Use Cases

### Core
- AV detection hacktool (cleaned or not) [AV cheatsheet @FlorianRoth](https://www.nextron-systems.com/wp-content/uploads/2021/03/Antivirus_Event_Analysis_CheatSheet_1.8.1.pdf) 
- User added to local admin
  - https://github.com/SigmaHQ/sigma/blob/8b749fb1260b92b9170e4e69fa1bd2f34e94d766/rules/windows/builtin/security/win_security_user_added_to_local_administrators.yml
 

### Servers
- Webshell spawn
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_spawn.yml
- webshell recon commands
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_detection.yml
- whoami as SYSTEM
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_whoami_as_system.yml
- Enumerate local groups 
  - https://github.com/gonzalomarcos/BasiCUs/blob/main/rules/win_security_local_groups_enumeration.yml

### Endpoints
- Scheduled tasks
  - https://github.com/SigmaHQ/sigma/blob/8b749fb1260b92b9170e4e69fa1bd2f34e94d766/rules/windows/builtin/security/win_security_rare_schtasks_creations.yml
- Office launching command
  - https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_office_shell.yml
- Clear command history
  - https://github.com/SigmaHQ/sigma/blob/8b749fb1260b92b9170e4e69fa1bd2f34e94d766/rules/windows/builtin/security/win_security_event_log_cleared.yml



### DCs/AD
- Special user logon
  - https://github.com/SigmaHQ/sigma/blob/8b749fb1260b92b9170e4e69fa1bd2f34e94d766/rules/windows/builtin/security/win_security_admin_logon.yml
- User added to admin groups
- Login outside jump servers
  - https://github.com/gonzalomarcos/BasiCUs/blob/main/rules/win_security_ad_logon_outside_jumpservers.yml
- Kerberoasting
  - https://github.com/SigmaHQ/sigma/blob/8b749fb1260b92b9170e4e69fa1bd2f34e94d766/rules/windows/builtin/security/win_security_susp_rc4_kerberos.yml


### ATMs
- Enumerate local groups
  - https://github.com/gonzalomarcos/BasiCUs/blob/main/rules/win_security_local_groups_enumeration.yml
- whoami executed
  - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_whoami.yml
